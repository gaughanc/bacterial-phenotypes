from django.core.management.base import BaseCommand, CommandError
from wb0.models import Genus, Species

class Command(BaseCommand):
    help = "Prints list of genera names and grouped list of species names"

    def handle(self, *args, **options):
        working_genera = ['Bacteroides', 'Prevotella', 'Akkermansia', 'Anaerostripes', 'Anaerotruncas', 'Barnesiella', 'Blautia', 'Roseburia', 'Alloprevotella', 'Porphyromonas', 'Paraprevotella', 'Parabacteroides', 'Oscillibacter', 'Odoribacter', 'Faecalibacterium', 'Enterobacter', 'Shuttleworthia', 'Sediminibacterium', 'Peptoniphilus', 'Moryella', 'Holdemania', 'Gordonibacter', 'Dorea', 'Sutterella', 'Sporobacter', 'Pseudoflavonifractor', 'Flavonifractor', 'Achromobacter', 'Aerococcus', 'Catenibacterium', 'Collinsella', 'Aggregatibacter', 'Anaerococcus', 'Succinivibrio', 'Lachnospira', 'Parasutterella', 'Paralactobacillus', 'Oribacterium', 'Ochrobactrum', 'Murdochiella', 'Mogibacterium', 'Megasphaera', 'Hallella', 'Johnsonella', 'Granulicatella', 'Gemmiger', 'Gardnerella', 'Facklamia', 'Enterococcus', 'Dialister', 'Delftia', 'Cronobacter', 'Citrobacter', 'Chryseobacterium', 'Centipeda', 'Butyricicoccus', 'Bulleidia', 'Brevundimonas', 'Anaeroglobus', 'Arthrobacter', 'Atopobium', 'Bacillus', 'Butyricimonas', 'Deinococcus', 'Helicobacter', 'Microbacterium', 'Pseudobutyrivibrio', 'Schwartzia', 'Succiniclasticum', 'Tannerella', 'Alistipes', 'Catonella', 'Kingella', 'Eremococcus', 'Variovorax', 'Slackia', 'Pyramidobacter', 'Abiotrophia', 'Bordetella', 'Parascardovia', 'Olsenella', 'Jonquetella', 'Xylanibacter', 'Eikenella', 'Christensenella', 'Acidaminococcus', 'Oribaculum', 'Oribaculum', 'Cellulosimicrobium', 'Enterorhabdus', 'Anarosalibacter', 'Murimonas', 'Terrisporobacter', 'Intestinimonas', 'Stenotrophomonas', 'Aminobacter', 'Bradyrhizobium', 'Curvibacter', 'Curvibacter', 'Herbaspirillum', 'Turicibacter', 'Rothia', 'Pedobacter', 'Parvibacter', 'Acidovorax', 'Aeromicrobium', 'Afipia', 'Aquabacterium', 'Aurantimonas', 'Azoarcus', 'Xanthomonas', 'Papillibacter', 'Lachnobacterium', 'Azospira', 'Beutenbergia', 'Micrococcus', 'Polaromonas', 'Pseudoxanthomonas', 'Psychrobacter', 'Sphingobium', 'Sphingomonas', 'Sphingopyxis', 'Sulfuritalea', 'Tsukamurella', 'Undibacterium', 'Bosea', 'Brevibacillus', 'Caulobacter', 'Comamonas', 'Craurococcus', 'Cupriavidus', 'Devosia', 'Dietzia', 'Duganella', 'Dyadobacter', 'Enhydrobacter', 'Hoeflea', 'Hydrotalea', 'Janthinobacterium', 'Bifidobacterium', 'Kocuria', 'Limnobacter', 'Mesorhizobium', 'Methylophilus', 'Methyloversatilis', 'Microlunatus', 'Niastella', 'Novosphingobium', 'Olivibacter', 'Paracoccus', 'Patulibacter', 'Wautersiella', 'Actinobaculum', 'Anaerotruncus']
        working_species = [['Bacteroides vulgatus', 'Bacteroides acidifaciens', 'Bacteroides caecimuris', 'Bacteroides ovatus', 'Bacteroides xylanisolvens', 'Bacteroides amylophilus', 'Bacteroides barnesiae', 'Bacteroides bivius', 'Bacteroides buccae', 'Bacteroides caccae', 'Bacteroides caecicola', 'Bacteroides caecigallinarum', 'Bacteroides cellulosilyticus', 'Bacteroides cellulosolvens', 'Bacteroides chinchillae', 'Bacteroides clarus', 'Bacteroides coagulans', 'Bacteroides coprocola', 'Bacteroides coprophilus', 'Bacteroides coprosuis', 'Bacteroides corporis', 'Bacteroides disiens', 'Bacteroides distasonis', 'Bacteroides dorei', 'Bacteroides eggerthii', 'Bacteroides faecichinchillae', 'Bacteroides faecis', 'Bacteroides finegoldii', 'Bacteroides fluxus', 'Bacteroides forsythus', 'Bacteroides gallinaceum', 'Bacteroides gallinarum', 'Bacteroides gingivalis', 'Bacteroides gracilis', 'Bacteroides graminisolvens', 'Bacteroides heparinolyticus', 'Bacteroides intermedius', 'Bacteroides intestinalis', 'Bacteroides levii', 'Bacteroides loescheii', 'Bacteroides luti', 'Bacteroides massiliensis', 'Bacteroides microfusus', 'Bacteroides multiacidus', 'Bacteroides oleiciplenus', 'Bacteroides oralis', 'Bacteroides oris', 'Bacteroides oulorum'], ['Prevotella amnii', 'Prevotella copri'], ['Akkermansia muciniphila'], ['Anaerostripes butyraticus'], [], ['Barnesiella viscericola'], ['Blautia faecis', 'Blautia wexlerae', 'Blautia caecimuris', 'Blautia coccoides', 'Blautia stercoris', 'Blautia wexlerae'], ['Roseburia cecicola', 'Roseburia faecis', 'Roseburia hominis', 'Roseburia inulinivorans'], ['Alloprevotella tannerae', 'Alloprevotella rava'], ['Porphyromonas asaccharolytica', 'Porphyromonas gingivalis'], ['Paraprevotella clara'], ['Parabacteroides distasonis', 'Parabacteroides goldsteinii', 'Parabacteroides merdae', 'Parabacteroides johnsonii'], ['Oscillibacter valericigenes', 'Oscillibacter ruminantium'], ['Odoribacter denticanis'], ['Faecalibacterium prausnitzii'], [], ['Shuttleworthia satelles'], ['Sediminibacterium salmoneum'], ['Peptoniphilus asaccharolyticus'], ['Moryella indoligenes'], ['Holdemania filiformis'], ['Gordonibacter pamelaeae'], ['Dorea formicigenerans', 'Dorea longicatena'], ['Sutterella wadsworthensis'], ['Sporobacter termitidis'], ['Pseudoflavonifractor capillosus'], ['Flavonifractor plautii'], ['Achromobacter xylosoxidans'], ['Aerococcus christensenii'], ['Catenibacterium mitsuokai'], ['Collinsella aerofaciens'], ['Aggregatibacter actinomycetemcomitans'], ['Anaerococcus prevotii', 'Anaerococcus tetradius', 'Anaerococcus hydrogenalis', 'Anaerococcus lactolyticus', 'Anaerococcus octavius', 'Anaerococcus vaginalis'], ['Succinivibrio dextrinosolvens'], ['Lachnospira multipara'], ['Parasutterella excrementihominis'], ['Paralactobacillus selangorensis'], ['Oribacterium sinus'], ['Ochrobactrum anthropi'], ['Murdochiella asaccharolytica'], ['Mogibacterium pumilum', 'Mogibacterium vescum'], ['Megasphaera micronuciformis'], ['Hallella seregens'], ['Johnsonella ignava'], ['Granulicatella adiacens', 'Granulicatella elegans', 'Granulicatella balaenopterae'], [], ['Gardnerella vaginalis'], ['Facklamia hominis'], ['Enterococcus faecalis', 'Enterococcus faecium', 'Enterococcus gallinarum', 'Enterococcus hirae'], ['Dialister pneumosintes'], ['Delftia acidovorans'], [], [], [], ['Centipeda periodontii'], ['Butyricicoccus pullicaecorum'], ['Bulleidia extructa'], ['Brevundimonas diminuta', 'Brevundimonas vesicularis'], ['Anaeroglobus geminatus'], ['Arthrobacter agilis'], ['Atopobium deltae'], ['Bacillus thermoamylovorans'], ['Butyricimonas synergistica', 'Butyricimonas virosa'], [], ['Helicobacter pylori', 'Helicobacter mustelae'], ['Microbacterium immunditiarum'], ['Pseudobutyrivibrio ruminis'], ['Schwartzia succinivorans'], ['Succiniclasticum ruminis'], ['Tannerella forsythia'], ['Alistipes indistinctus', 'Alistipes inops', 'Alistipes onderdonkii', 'Alistipes shahii'], ['Catonella morbi'], ['Kingella orale'], ['Eremococcus coleocola'], ['Variovorax paradoxus'], [], ['Pyramidobacter piscolens'], [], ['Bordetella petrii'], [], ['Olsenella uli'], ['Jonquetella antrhopi'], ['Xylanibacter oryzae'], ['Eikenella corrodens'], ['Christensenella minuta'], ['Acidaminococcus fermentans'], ['Oribaculum catoniae'], ['Oribaculum catoniae'], ['Cellulosimicrobium cellulans'], ['Enterorhabdus mucosicola', 'Enterorhabdus caecimuris'], [], ['Murimonas intestini'], [], ['Intestinimonas butyriciproducens'], ['Stenotrophomonas maltophilia'], ['Aminobacter aminovorans', 'Aminobacter aganoensis'], ['Bradyrhizobium japonicum'], ['Curvibacter gracilis', 'Curvibacter gracilis'], ['Curvibacter gracilis', 'Curvibacter gracilis'], ['Herbaspirillum seropedicae'], ['Turicibacter sanguinis'], ['Rothia aeria', 'Rothia nasimurium'], ['Pedobacter heparinus'], ['Parvibacter caecicola'], ['Acidovorax  facilis'], ['Aeromicrobium'], ['Afipia felis'], ['Aquabacterium commune'], ['Aurantimonas coralicida'], ['Azoarcus indigens'], [], ['Papillibacter cinnamivorans'], ['Lachnobacterium bovis'], ['Azospira oryzae'], ['Beutenbergia cavernae'], [], ['Polaromonas vacuolata'], [], ['Psychrobacter immobilis'], ['Sphingobium yanoikuyae'], [], ['Sphingopyxis macrogoltabida'], ['Sulfuritalea hydrogenivorans'], ['Tsukamurella paurometabolum'], ['Undibacterium pigrum'], ['Bosea thiooxidans'], [], [], ['Comamonas terrigena'], ['Craurococcus roseus'], [], ['Devosia riboflavina'], ['Dietzia maris'], ['Duganella zoogloeoides'], ['Dyadobacter fermentans'], ['Enhydrobacter aerosaccus'], ['Hoeflea marina'], ['Hydrotalea flava'], [], ['Bifidobacterium dentium', 'Bifidobacterium animalis'], ['Kocuria rosea'], ['Limnobacter thiooxidans'], [], ['Methylophilus methylotrophus'], ['Methyloversatilis universalis'], ['Microlunatus phosphovorus'], ['Niastella koreensis'], [], ['Olivibacter sitiensis'], [], ['Patulibacter minatonensis'], ['Wautersiella falsenii'], ['Actinobaculum suis'], ['Anaerotruncus colihominis', 'Anaerotruncus colihominis']]
        working_catalase = [['not indicated', 'not indicated', 'not indicated', 'not indicated', 'catalase negative', 'not indicated', 'catalase negative', 'not indicated', 'not indicated', 'not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'not indicated', 'not indicated', 'catalase negative', 'not indicated', 'catalase negative', 'not indicated', 'not indicated', 'not indicated', 'not indicated', 'not indicated', 'catalase negative', 'catalase negative', 'not indicated', 'not indicated', 'not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'not indicated', 'catalase negative', 'not indicated', 'not indicated', 'catalase negative', 'not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'not indicated', 'not indicated', 'catalase negative', 'not indicated', 'not indicated'], ['not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'not indicated', 'catalase negative', 'not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'not indicated', 'catalase negative', 'not indicated', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative', 'catalase negative'], ['not indicated'], ['not indicated'], [], ['catalase negative', 'catalase negative'], ['catalase negative', 'catalase negative', 'not indicated', 'not indicated', 'catalase negative', 'catalase negative'], ['catalase negative', 'catalase negative', 'catalase negative', 'catalase negative'], ['not indicated', 'not indicated'], ['not indicated', 'not indicated'], ['not indicated'], ['catalase positive', 'not indicated', 'catalase negative', 'catalase positive'], ['catalase negative', 'catalase negative'], ['catalase positive'], ['not indicated'], [], ['catalase negative'], ['catalase positive'], ['not indicated'], ['catalase negative'], ['catalase negative'], ['catalase positive'], ['not indicated', 'catalase negative'], ['not indicated'], ['not indicated'], ['not indicated'], ['not indicated'], ['catalase positive'], ['catalase negative'], ['not indicated'], ['not indicated'], ['catalase positive'], ['not indicated', 'not indicated', 'not indicated', 'not indicated', 'not indicated', 'not indicated'], ['not indicated'], ['catalase negative'], ['catalase negative'], ['catalase negative'], ['catalase negative'], ['catalase positive'], ['catalase negative'], ['catalase negative', 'catalase negative'], ['catalase negative'], ['not indicated'], ['catalase negative'], ['catalase negative', 'catalase negative', 'catalase negative'], [], ['not indicated'], ['catalase negative'], ['not indicated', 'not indicated', 'not indicated', 'catalase negative'], ['not indicated', 'not indicated', 'not indicated'], ['catalase positive'], [], [], [], ['not indicated'], ['not indicated'], ['catalase negative'], ['not indicated', 'not indicated'], ['catalase negative'], ['catalase positive'], ['not indicated'], ['catalase positive'], ['catalase negative', 'catalase positive'], [], ['catalase positive', 'catalase positive'], ['catalase positive'], ['not indicated'], ['catalase negative'], ['catalase negative'], ['catalase negative'], ['catalase positive', 'catalase negative', 'catalase negative', 'catalase negative'], ['not indicated'], ['catalase negative'], ['catalase negative'], ['catalase positive'], [], ['catalase negative'], [], ['not indicated'], [], ['catalase negative'], ['catalase negative'], ['catalase negative'], ['catalase negative'], ['catalase negative'], ['not indicated'], ['not indicated'], ['not indicated'], ['catalase positive'], ['catalase negative', 'not indicated'], [], ['not indicated'], [], ['not indicated'], ['not indicated'], ['catalase positive', 'catalase positive'], ['not indicated'], ['catalase positive', 'catalase positive'], ['catalase positive', 'catalase positive'], ['catalase positive'], ['catalase negative'], ['not indicated', 'catalase positive'], ['catalase positive'], ['not indicated'], ['not indicated'], ['catalase positive'], ['catalase positive'], ['catalase negative'], ['catalase positive'], ['catalase positive'], [], ['not indicated'], ['not indicated'], ['catalase positive'], ['catalase positive'], [], ['catalase positive'], [], ['catalase positive'], ['catalase positive'], [], ['catalase positive'], ['catalase negative'], ['catalase positive'], ['not indicated'], ['catalase positive'], [], [], ['catalase positive'], ['catalase positive'], [], ['catalase positive'], ['catalase positive'], ['catalase positive'], ['catalase positive'], ['catalase positive'], ['catalase positive'], ['catalase positive'], [], ['catalase negative', 'catalase negative'], ['catalase positive'], ['not indicated'], [], ['catalase positive'], ['catalase positive'], ['catalase positive'], ['not indicated'], [], ['not indicated'], [], ['catalase positive'], ['not indicated'], ['catalase negative'], ['catalase negative', 'catalase negative']]        
        working_catcount = [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]
        genera = []
        species = []
        catalase = []
        catcount = []
        s_oxygen = []
        g_oxygen = []
        for i, g in enumerate(Genus.objects.all()):
            genusname = getattr(g, "name")
            genera.append(genusname)
            catcount.append([0, 0])
            g_oxygen.append(getattr(g, "aerobic_status"))
            for l in [species, catalase, s_oxygen]:
                l.append([])
            # Fudge, include deleted repeats to match working version
            if genusname == "Oribaculum" or genusname == "Curvibacter":
                genera.append(genusname)
                catcount.append([0, 0])
                g_oxygen.append(getattr(g, "aerobic_status"))
            for s in Species.objects.all():
                speciesname = getattr(s, "name")
                if genusname in speciesname:    
                    species[i].append(speciesname)
                    catalase[i].append(getattr(s, "catalase"))
                    s_oxygen[i].append(getattr(s, "aerobic_status"))
                    if speciesname == species[i][-1]:
                        break
            if genera == working_genera:
                break
        l = [genera, catcount, g_oxygen]
        for i, lname in enumerate(["genera", "catcount", "g_oxygen"]):
            print("\n".join(["def get_"+lname+"():", "    "+lname+" = "+str(l[i]), "    return "+lname, ""]))
